{"version":3,"file":"index.js","sources":["../src/HttpError.ts","../src/errorsMiddleware.ts","../src/AbstractError.ts","../src/NotFoundError.ts"],"sourcesContent":["/**\n *\n */\nexport class HttpError extends Error {\n  constructor(\n    public statusCode: number,\n    public message: string,\n    public details?: any,\n    public errorCode?: number,\n    public parentError?: Error\n  ) {\n    super(message)\n\n    if (parentError) this.stack = parentError.stack\n  }\n\n  /**\n   * Factory of\n   * HTTP Error 400 Bad Request\n   */\n  public static BadRequest(options?: OptionsErrorFactory) {\n    return prepareHttpError(400, 'Bad Request', options)\n  }\n\n  /**\n   * Factory of\n   * HTTP Error 401 Not Found\n   */\n  public static Unauthorized(options?: OptionsErrorFactory) {\n    return prepareHttpError(401, 'Unauthorized', options)\n  }\n\n  /**\n   * Factory of\n   * HTTP Error 402 PaymentRequired\n   */\n  public static PaymentRequired(options?: OptionsErrorFactory) {\n    return prepareHttpError(402, 'Payment Required', options)\n  }\n\n  /**\n   * Factory of\n   * HTTP Error 403 Forbidden\n   */\n  public static Forbidden(options?: OptionsErrorFactory) {\n    return prepareHttpError(403, 'Forbidden', options)\n  }\n\n  /**\n   * Factory of\n   * HTTP Error 404 Not Found\n   */\n  public static NotFound(options?: OptionsErrorFactory) {\n    return prepareHttpError(404, 'Not Found', options)\n  }\n\n  /**\n   * Factory of\n   * HTTP Error 405 Method Not Allowed\n   */\n  public static MethodNotAllowed(options?: OptionsErrorFactory) {\n    return prepareHttpError(405, 'Method Not Allowed', options)\n  }\n\n  /**\n   * Factory of\n   * HTTP Error 406 Not Acceptable\n   */\n  public static NotAcceptable(options?: OptionsErrorFactory) {\n    return prepareHttpError(406, 'Not Acceptable', options)\n  }\n\n  /**\n   * Factory of\n   * HTTP Error 409 Conflict\n   */\n  public static Conflict(options?: OptionsErrorFactory) {\n    return prepareHttpError(409, 'Conflict', options)\n  }\n\n  /**\n   * Factory of\n   * HTTP Error 410 Gone\n   */\n  public static Gone(options?: OptionsErrorFactory) {\n    return prepareHttpError(410, 'Gone', options)\n  }\n\n  /**\n   * Factory of\n   * HTTP Error 422 Unprocessable Entity\n   */\n  public static UnprocessableEntity(options?: OptionsErrorFactory) {\n    return prepareHttpError(422, 'Unprocessable Entity', options)\n  }\n\n  /**\n   * Factory of\n   * HTTP Error 423 Locked\n   */\n  public static Locked(options?: OptionsErrorFactory) {\n    return prepareHttpError(423, 'Locked', options)\n  }\n\n  /**\n   * Factory of\n   * HTTP Error 500 Internal Server Error\n   */\n  public static InternalServerError(options?: OptionsErrorFactory) {\n    return prepareHttpError(500, 'Internal Server Error', options)\n  }\n}\n\n/**\n *\n * @param statusCode\n * @param defaultMessage\n * @param options\n */\nfunction prepareHttpError(statusCode: number, defaultMessage: string, options: OptionsErrorFactory) {\n  if (typeof options === 'string' || !options) return new HttpError(statusCode, options || defaultMessage)\n  return new HttpError(statusCode, options.message || defaultMessage, options.details, options.errorCode, options.error)\n}\n\nexport interface OptionsErrorFactoryObject {\n  message?: string\n  error?: Error\n  details?: any\n  errorCode?: number\n}\n\nexport type OptionsErrorFactory = OptionsErrorFactoryObject | string | undefined\n","import { ErrorRequestHandler } from 'express'\nimport { HttpError } from './HttpError'\n\n/**\n *\n */\nexport const errorsMiddleware = (options?: any) => {\n  // Default options\n  options = options || {\n    debugServer: false,\n    debugClient: false,\n    skipClientError: false\n  }\n\n  const errorHandler: ErrorRequestHandler = (err, req, res, next) => {\n    err = err.defaultHttpClassError || err\n\n    const statusCode = err.statusCode || 500\n\n    if (options.debugServer && ((!options.skipClientError && statusCode < 500) || statusCode >= 500)) console.error(err)\n    if (statusCode === 500) err = HttpError.InternalServerError()\n\n    const { message, defaultHttpClassError } = err\n\n    const stack = options.debugClient ? err.stack : undefined\n    const errorCode = err.errorCode ? 'E' + err.errorCode.toString().padStart(5, '0') : undefined\n    const details = err.details || undefined\n\n    res.status(statusCode).json({\n      statusCode,\n      errorCode,\n      message,\n      details,\n      stack\n    })\n  }\n\n  return errorHandler\n}\n","import { CustomError } from 'ts-custom-error'\nimport { HttpError } from './HttpError'\n\n/**\n *\n */\nexport abstract class AbstractError extends CustomError {\n  public abstract code: number\n\n  constructor(message: string) {\n    super(message)\n  }\n}\n\n/**\n *\n */\nexport interface CanThrowHttpError {\n  defaultHttpClassError: HttpError\n}\n","import { AbstractError, CanThrowHttpError } from './AbstractError'\nimport { HttpError } from './HttpError'\n\n/**\n *\n */\nexport class NotFoundError extends AbstractError implements CanThrowHttpError {\n  public code: number = 100\n\n  public defaultHttpClassError: HttpError = HttpError.NotFound({\n    message: this.message,\n    errorCode: this.code\n  })\n\n  constructor(resource: string) {\n    super(`No ${resource} found in database.`)\n  }\n}\n"],"names":["CustomError"],"mappings":";;;;;;AAAA;;;AAGA,MAAa,SAAU,SAAQ,KAAK;IAClC,YACS,UAAkB,EAClB,OAAe,EACf,OAAa,EACb,SAAkB,EAClB,WAAmB;QAE1B,KAAK,CAAC,OAAO,CAAC,CAAA;QANP,eAAU,GAAV,UAAU,CAAQ;QAClB,YAAO,GAAP,OAAO,CAAQ;QACf,YAAO,GAAP,OAAO,CAAM;QACb,cAAS,GAAT,SAAS,CAAS;QAClB,gBAAW,GAAX,WAAW,CAAQ;QAI1B,IAAI,WAAW;YAAE,IAAI,CAAC,KAAK,GAAG,WAAW,CAAC,KAAK,CAAA;KAChD;;;;;IAMM,OAAO,UAAU,CAAC,OAA6B;QACpD,OAAO,gBAAgB,CAAC,GAAG,EAAE,aAAa,EAAE,OAAO,CAAC,CAAA;KACrD;;;;;IAMM,OAAO,YAAY,CAAC,OAA6B;QACtD,OAAO,gBAAgB,CAAC,GAAG,EAAE,cAAc,EAAE,OAAO,CAAC,CAAA;KACtD;;;;;IAMM,OAAO,eAAe,CAAC,OAA6B;QACzD,OAAO,gBAAgB,CAAC,GAAG,EAAE,kBAAkB,EAAE,OAAO,CAAC,CAAA;KAC1D;;;;;IAMM,OAAO,SAAS,CAAC,OAA6B;QACnD,OAAO,gBAAgB,CAAC,GAAG,EAAE,WAAW,EAAE,OAAO,CAAC,CAAA;KACnD;;;;;IAMM,OAAO,QAAQ,CAAC,OAA6B;QAClD,OAAO,gBAAgB,CAAC,GAAG,EAAE,WAAW,EAAE,OAAO,CAAC,CAAA;KACnD;;;;;IAMM,OAAO,gBAAgB,CAAC,OAA6B;QAC1D,OAAO,gBAAgB,CAAC,GAAG,EAAE,oBAAoB,EAAE,OAAO,CAAC,CAAA;KAC5D;;;;;IAMM,OAAO,aAAa,CAAC,OAA6B;QACvD,OAAO,gBAAgB,CAAC,GAAG,EAAE,gBAAgB,EAAE,OAAO,CAAC,CAAA;KACxD;;;;;IAMM,OAAO,QAAQ,CAAC,OAA6B;QAClD,OAAO,gBAAgB,CAAC,GAAG,EAAE,UAAU,EAAE,OAAO,CAAC,CAAA;KAClD;;;;;IAMM,OAAO,IAAI,CAAC,OAA6B;QAC9C,OAAO,gBAAgB,CAAC,GAAG,EAAE,MAAM,EAAE,OAAO,CAAC,CAAA;KAC9C;;;;;IAMM,OAAO,mBAAmB,CAAC,OAA6B;QAC7D,OAAO,gBAAgB,CAAC,GAAG,EAAE,sBAAsB,EAAE,OAAO,CAAC,CAAA;KAC9D;;;;;IAMM,OAAO,MAAM,CAAC,OAA6B;QAChD,OAAO,gBAAgB,CAAC,GAAG,EAAE,QAAQ,EAAE,OAAO,CAAC,CAAA;KAChD;;;;;IAMM,OAAO,mBAAmB,CAAC,OAA6B;QAC7D,OAAO,gBAAgB,CAAC,GAAG,EAAE,uBAAuB,EAAE,OAAO,CAAC,CAAA;KAC/D;CACF;;;;;;;AAQD,SAAS,gBAAgB,CAAC,UAAkB,EAAE,cAAsB,EAAE,OAA4B;IAChG,IAAI,OAAO,OAAO,KAAK,QAAQ,IAAI,CAAC,OAAO;QAAE,OAAO,IAAI,SAAS,CAAC,UAAU,EAAE,OAAO,IAAI,cAAc,CAAC,CAAA;IACxG,OAAO,IAAI,SAAS,CAAC,UAAU,EAAE,OAAO,CAAC,OAAO,IAAI,cAAc,EAAE,OAAO,CAAC,OAAO,EAAE,OAAO,CAAC,SAAS,EAAE,OAAO,CAAC,KAAK,CAAC,CAAA;CACvH;;ACvHD;;;AAGA,MAAa,gBAAgB,GAAG,CAAC,OAAa;;IAE5C,OAAO,GAAG,OAAO,IAAI;QACnB,WAAW,EAAE,KAAK;QAClB,WAAW,EAAE,KAAK;QAClB,eAAe,EAAE,KAAK;KACvB,CAAA;IAED,MAAM,YAAY,GAAwB,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,IAAI;QAC5D,GAAG,GAAG,GAAG,CAAC,qBAAqB,IAAI,GAAG,CAAA;QAEtC,MAAM,UAAU,GAAG,GAAG,CAAC,UAAU,IAAI,GAAG,CAAA;QAExC,IAAI,OAAO,CAAC,WAAW,KAAK,CAAC,CAAC,OAAO,CAAC,eAAe,IAAI,UAAU,GAAG,GAAG,KAAK,UAAU,IAAI,GAAG,CAAC;YAAE,OAAO,CAAC,KAAK,CAAC,GAAG,CAAC,CAAA;QACpH,IAAI,UAAU,KAAK,GAAG;YAAE,GAAG,GAAG,SAAS,CAAC,mBAAmB,EAAE,CAAA;QAE7D,MAAM,EAAE,OAAO,EAAE,qBAAqB,EAAE,GAAG,GAAG,CAAA;QAE9C,MAAM,KAAK,GAAG,OAAO,CAAC,WAAW,GAAG,GAAG,CAAC,KAAK,GAAG,SAAS,CAAA;QACzD,MAAM,SAAS,GAAG,GAAG,CAAC,SAAS,GAAG,GAAG,GAAG,GAAG,CAAC,SAAS,CAAC,QAAQ,EAAE,CAAC,QAAQ,CAAC,CAAC,EAAE,GAAG,CAAC,GAAG,SAAS,CAAA;QAC7F,MAAM,OAAO,GAAG,GAAG,CAAC,OAAO,IAAI,SAAS,CAAA;QAExC,GAAG,CAAC,MAAM,CAAC,UAAU,CAAC,CAAC,IAAI,CAAC;YAC1B,UAAU;YACV,SAAS;YACT,OAAO;YACP,OAAO;YACP,KAAK;SACN,CAAC,CAAA;KACH,CAAA;IAED,OAAO,YAAY,CAAA;CACpB;;ACnCD;;;AAGA,MAAsB,aAAc,SAAQA,yBAAW;IAGrD,YAAY,OAAe;QACzB,KAAK,CAAC,OAAO,CAAC,CAAA;KACf;CACF;;ACTD;;;AAGA,MAAa,aAAc,SAAQ,aAAa;IAQ9C,YAAY,QAAgB;QAC1B,KAAK,CAAC,MAAM,QAAQ,qBAAqB,CAAC,CAAA;QARrC,SAAI,GAAW,GAAG,CAAA;QAElB,0BAAqB,GAAc,SAAS,CAAC,QAAQ,CAAC;YAC3D,OAAO,EAAE,IAAI,CAAC,OAAO;YACrB,SAAS,EAAE,IAAI,CAAC,IAAI;SACrB,CAAC,CAAA;KAID;CACF;;;;;;;"}